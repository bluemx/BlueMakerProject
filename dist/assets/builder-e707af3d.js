import{N as D,u as k,l as n,s}from"./app-0bf7be56.js";const S=D("builder",()=>{const d=k(),u=n(null),o=n(null),r=n(),c=n(),v=n(null),i=n(),l=n({}),f=async(e,a)=>{const{data:t,error:B}=await s.from("documents").insert([{key:e,content:a}]).select().single();d.push(`/${u.value}/${t.key}`)},y=async e=>{c.value=e;const{data:a,error:t}=await s.from("documents").select("*").eq("key",e).single();return o.value=a,m(),!0},p=()=>o.value?o.value.content:null,g=e=>{const{data:a}=s.storage.from(u.value).getPublicUrl(c.value+"/"+e);return a.publicUrl},w=async()=>{await s.from("documents").update(o.value).eq("key",c.value)},b=()=>{},h=async()=>{const{data:e,error:a}=await s.from("modulos").select("*").eq("type",u.value);return e.value=e,e==null||e.forEach(t=>{l.value[t.name]={...t.schema,icon:t.icon}}),e},m=async()=>{r.value=[];const{data:e,error:a}=await s.storage.from(u.value).list(c.value,{limit:100,offset:0,sortBy:{column:"name",order:"asc"}});e.forEach(t=>{r.value.push({name:t.name,url:g(t.name),mimetype:t.metadata.mimetype})})};return{menu:v,type:u,doc:o,dockey:c,files:r,modulos:i,modulosobj:l,newDoc:f,loadDoc:y,getContent:p,updateAssets:m,saveDoc:w,downloadDoc:b,loadModulos:h,metadata:(e,a)=>{var t;(t=o.value.content)!=null&&t.metadata||(o.value.content.metadata={}),o.value.content.metadata[e]=a}}});export{S as u};
