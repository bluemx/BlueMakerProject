async function getViteClient(base = "/", warning = true) {
  try {
    return await import(
      /* @vite-ignore */
      `${base}@vite/client`
    );
  } catch {
    if (warning)
      console.error(`[vite-plugin-hot] Failed to import "${base}@vite/client"`);
  }
  return void 0;
}
async function createHotContext(path = "/____", base = "/") {
  const viteClient = await getViteClient(base);
  return viteClient?.createHotContext(path);
}
function guessBasesFromPathname(pathname = window.location.pathname) {
  return pathname.split("/").map((i, idx, arr) => arr.slice(0, idx + 1).join("/") || "/");
}
async function tryCreateHotContext(path = "/___", bases) {
  bases = bases ?? guessBasesFromPathname();
  for (const base of bases) {
    const viteClient = await getViteClient(base, false);
    const hot = viteClient?.createHotContext(path);
    if (hot)
      return hot;
  }
  console.error("[vite-plugin-hot] Failed to import vite client, tried with:", bases);
}

export { createHotContext, getViteClient, guessBasesFromPathname, tryCreateHotContext };
